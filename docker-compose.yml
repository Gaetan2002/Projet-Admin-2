version: '1.0'
services:
  dns_internal:
    build: ./sz/dns_internal
    container_name: dns_internal
    dns:
      - 192.168.1.2
    networks:
      sz:
        ipv4_address: 192.168.1.2
        aliases:
          - ns.internal.l1-6.ephec-ti.be
  dovecot:
    build: ./sz/dovecot
    container_name: dovecot
    ports:
      - '143'
      - '993'
    networks:
      sz:
        ipv4_address: 192.168.1.3
        aliases:
          - dovecot.internal.l1-6.ephec-ti.be
  mysql:
    build: ./sz/mysql
    container_name: mysql
    command: --default-authentication-plugin=mysql_native_password
    restart: always
    env_file: ./sz/mysql/env.list
    networks:
      sz:
        ipv4_address: 192.168.1.4
        aliases:
          - mysql.internal.l1-6.ephec-ti.be
  user:
    build: ./users
    container_name: user
    command: tail -f /dev/null
    dns:
      - 192.168.1.2
    networks:
      users:
        ipv4_address: 192.168.1.5
      sz:

networks:
  dmz:
    ipam:
      driver: default
      config:
        - subnet: 192.168.2.0/24
          gateway: 192.168.2.1
  sz:
    ipam:
      driver: default
      config:
        - subnet: 192.168.1.0/24
          gateway: 192.168.1.1
  users:
    ipam:
      driver: default
      config:
        - subnet: 192.168.0.0/24
          gateway: 192.168.0.1
